# MCP Adapter (IntentusNet v1)

This document describes the **MCP Adapter** in IntentusNet v1.
It explains how IntentusNet can act as a backend execution engine
for MCP-style tool calls **without modifying MCP semantics**.

The MCP adapter is a **thin translation layer**, not a protocol replacement.

---

## Purpose of the MCP Adapter

The MCP adapter exists to:

- Accept MCP-compliant tool invocation requests
- Translate them into `IntentEnvelope` objects
- Route them through the IntentusNet runtime
- Translate results back into MCP responses

It allows IntentusNet to be used **behind** MCP,
not instead of it.

---

## What the MCP Adapter Is Not

The MCP adapter is **not**:

- An MCP server implementation
- An MCP authorization layer
- A protocol extension to MCP
- A replacement for MCP runtimes

It does not change MCP request or response formats.

---

## Adapter Position in the Stack

When the MCP adapter is used, the execution flow becomes:

```text
MCP Tool Call
   ↓
MCP Adapter
   ↓
IntentEnvelope
   ↓
IntentusNet Router
   ↓
AgentResponse
   ↓
MCP Tool Result
```

The adapter is a boundary translator.

---

## MCP → Intent Translation

For an incoming MCP tool request:

- `name` → `IntentRef.name`
- `arguments` → `IntentEnvelope.payload`
- Context and metadata are generated by the adapter

The adapter constructs a **new IntentEnvelope** for each request.

---

## Intent Routing

Once translated:

- The intent is routed exactly like any other IntentusNet intent
- Deterministic routing guarantees apply
- Fallback behavior is preserved

The router is unaware that the intent originated from MCP.

---

## Intent → MCP Response Translation

After routing completes:

- Successful `AgentResponse.payload` becomes the MCP tool result
- Errors are mapped into MCP error objects
- Structured error codes are preserved when possible

Only a **single response** is returned.

---

## Error Handling

Errors may occur during:

- Translation
- Routing
- Agent execution

The adapter ensures:

- Errors are normalized
- MCP always receives a valid response object
- No exceptions escape to the MCP caller

---

## Determinism and the MCP Adapter

Using the MCP adapter does not affect determinism:

- Agent selection is unchanged
- Routing order is preserved
- Fallback behavior is identical

The adapter adds **no routing logic**.

---

## EMCL Interaction

If EMCL is enabled:

- Encryption occurs after translation
- Decryption occurs before response translation
- MCP payloads are never routed in encrypted form

EMCL is transparent to MCP.

---

## Design Rationale

The MCP adapter is intentionally minimal to:

- Avoid protocol coupling
- Preserve MCP ownership
- Keep IntentusNet focused on routing

Any MCP-specific concerns remain external.

---

## Summary

In IntentusNet v1, the MCP adapter:

- Translates MCP tool calls into intents
- Routes them deterministically
- Returns MCP-compatible responses

It is a **bridge**, not a protocol fork.
